University: [ITMO University](https://itmo.ru/ru/)  
Faculty: [FICT](https://fict.itmo.ru)  
Course: [Network programming](https://github.com/itmo-ict-faculty/network-programming)  
Year: 2024/2025  
Group: K34202  
Author: Gusevskaya Arina  
Lab: Lab2 
Date of create: 10.10.2024  
Date of finished: 25.10.2024 

## Лабораторная работа №2 "Развертывание дополнительного CHR, первый сценарий Ansible"

<b>Описание:</b> В данной лабораторной работе будет осуществлено практическое знакомство с системой управления конфигурацией Ansible, использующейся для автоматизации настройки и развертывания программного обеспечения.
<p><b>Цель работы:</b> с помощью Ansible настроить несколько сетевых устройств и собрать информацию о них. Правильно собрать файл Inventory.</p>

### Ход работы
#### Развертывание дополнительного CHR
1. Создадим ВМ с помощью Oracle VirtualBox с образом, который был скачан с сайта mikrotik.com.

*Нужно скачать образ другой версии или сохранить файл в другой директории (переименовать), иначе конфигурация новой ВМ будет такая же, как у предыдущей. При первой настройке на второй ВМ у меня уже был настроен интерфейс wg первой машины (это помешало бы нам выполнить задания лабораторной). В итоге CHR называются Mikrotik и Mikrotik1.

<img src="img/monitor.png" width="500">

2. Запустим обе машины и убедимся, что они имеют разные ip-адреса.

<img src="img/ip1.png" width="500">
<img src="img/ip2.png" width="500">

3. В этот раз настроим CHR клиент через веб-интерфейс. Создадим интервейс wg2 на клиенте и соответствующий peer.

<img src="img/wg.png" width="500">
<img src="img/peer.png" width="500">

4. Добавим информацию о новом клиенте в конфигурационный файл wg0.conf в директории etc/wireguard/ на сервере.

<img src="img/conf.png" width="500">

5. Пропингуем сервер с клиентов, чтобы протестировать связь

<details>
   
<summary><b>Возникшие трудности</b></summary>
<p></p>

В лабораторной работе №1 было приянто решение развернуть VPN сервер на Google Cloud. При первом подключении VPN туннель был создан и протестирован успешно. Но при выполнении лабороторной работы №2 возникли трудности при попытке подключения. По совету преподавателя, было принято решение развернуть сервер на Yandex Cloud и повторно создать Wireguard VPN туннель c клиентом на ВМ Mikrotik.

1. Создадим ВМ в Yandex Cloud на образе Ubuntu 20.04.

![alt text](img/create.png)

2. Проверим конфигурацию и корректность работы ВМ.

![alt text](img/conf.png)


3. Установим python3 и ansible. Убедимся, что всё установлено корректно.
   
P.S. В команде проверки `ls -la /usr/bin/python3*` используем символ *, потому что мы не знаем, какая конкретно версия установлена и не можем её указать.

![alt text](img/install.png)

</details>

3. Схема сети будет выглядеть следующим образом. Приведем её без нанесения ip-адресов.

![alt text](img/Network.drawio.png)  




### 

Проверим доступ сервера (GCP) к клиенту (CHR).

![alt text](img/pingvm.png)

Поверим доступ клиента к серверу.

![alt text](img/pinggcp.png)

![alt text](img/pingipgcp.png)

Все пинги прошли успешно! Цель работы достигнута.

### Вывод
В ходе лабораторной работы с помощью Ansible были настроены сетевые устройства и собрана информация о них.

